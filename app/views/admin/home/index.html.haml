- content_for(:page, 'home')

%section#content
  = render 'layouts/partials/search'

  .page
    .row

      .col-12.col-md-6
        .card
          = link_to :members do
            .row.no-gutters
              %span.box-icon.bg-success
                %i.fa.fa-homepage.fa-user
              .card-body.box-info
                %h2.text-center
                  = @members
                %p.text-muted
                  = I18n.t('admin.members.title')

      .col-12.col-md-6
        .card
          = link_to :activities do
            .row.no-gutters
              %span.box-icon.bg-info
                %i.fa.fa-homepage.fa-ticket-alt
              .card-body.box-info
                %h2.text-center
                  = @activities
                %p.text-muted
                  = I18n.t('admin.activities.title')

      .col-12.col-md-6
        .card
          = link_to :checkout do
            .row.no-gutters
              %span.box-icon.bg-warning
                %i.fa.fa-homepage.fa-shopping-cart
              .card-body.box-info
                %h2.text-center
                  = @transactions
                %p.text-muted
                  = I18n.t('admin.front.checkout')

      .col-12.col-md-6
        .card
          = link_to :payments do
            .row.no-gutters
              %span.box-icon.bg-danger
                %i.fa.fa-homepage.fa-euro-sign
              .card-body.box-info
                %h2.text-center
                  = number_to_currency(@unpayed, :unit => '')
                %p.text-muted
                  = I18n.t('admin.front.outstanding_payments')

    .row
      .col-lg-3.d-none.d-sm-block
        .card
          .card-header
            %i.fa.fa-fw.fa-graduation-cap
            = I18n.t('admin.front.studies')

          %table.table.table-striped.table-linked
            %tbody
              - @studies.each do |code, count|
                %tr
                  %td= link_to I18n.t(code.downcase, scope: 'activerecord.attributes.study.names'), "/members?utf8=✓&search=studie:#{I18n.t(code.downcase, scope: 'activerecord.attributes.study.names').downcase.gsub( ' ', '-' )}"
                  %td= count

      .col-lg-4
        .card
          .card-header
            %i.fa.fa-fw.fa-shopping-cart
            = I18n.t('admin.front.transactions_today')
          %table.table.table-striped.table-linked
            %tbody
              - @recent.each do |transaction|
                %tr
                  %td= I18n.l transaction.created_at, :format => :short
                  %td{ :style => 'min-width: 80px;' }
                    = number_to_currency(transaction.price, :unit => '€')
                    - if transaction.price > 0
                      %span.fa.fa-sort-asc.float-right{ :style => 'padding-up: 3px;'}
                    - else
                      %span.fa.fa-sort-desc.float-right

                  %td{ :style => 'white-space: nowrap;' }
                    - unless transaction.checkout_balance.nil? || transaction.checkout_balance.member.nil?
                      = link_to "#{transaction.checkout_balance.member.name}", transaction.checkout_balance.member


                  %td.d-none.d-md-table-cell
                    = transaction.products

              - if @recent.empty?
                %tr
                  %td.text-center
                    %em
                      = I18n.t('admin.front.no_transactions')
      .col-lg-5
        .card
          .card-header
            %i.fa.fa-fw.fa-shopping-cart
            = I18n.t('admin.front.activity_transactions_today')
          %table.table.table-striped.table-linked
            %tbody
              - @recentactivities.each do |transaction|
                %tr
                  %td= I18n.l transaction.created_at, :format => :short
                  %td{ :style => 'min-width: 80px;' }
                    = number_to_currency(transaction.amount, :unit => '€')
                    - if transaction.amount > 0
                      %span.fa.fa-sort-asc.float-right{ :style => 'padding-up: 3px;'}
                    - else
                      %span.fa.fa-sort-desc.float-right

                  %td{ :style => 'white-space: nowrap;' }
                    = link_to "#{transaction.member.name}", transaction.member


                  %td.d-none.d-md-table-cell
                    = transaction.activities.map(&:name).join(', ')

              - if @recentactivities.empty?
                %tr
                  %td.text-center
                    %em= I18n.t('admin.front.no_transactions')
      .col-lg-3
        .card
          .card-header
            %i.fa.fa-fw.fa-ticket-alt
            = I18n.t('admin.front.defaulters')
          %table.table.table-striped.table-linked
            %tbody
              - @defaulters.each do |member, amount|
                %tr
                  %td= link_to member.name, member
                  %td= number_to_currency( amount, :unit => '€' )
